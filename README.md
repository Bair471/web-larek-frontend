# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```


или

```
yarn build
```
TEST 

UML-схема
[web-larek-green-black-text](https://github.com/user-attachments/assets/2873511a-7a66-41aa-9061-837d692969b8)


### Класс `Api`
Базовый класс для работы с HTTP-запросами. В конструктор передается основной URL сервера и необязательный объект с заголовками запросов.

- **constructor(baseUrl: string, options: RequestInit = {})**  
  Принимает URL сервера для выполнения запросов и общие параметры для запросов.

**Поля:**
- **baseUrl**  
  Основной адрес сервера.
- **options**  
  Объект с настройками заголовков для запросов.

**Методы:**
- **handleResponse**  
  Обрабатывает ответ от сервера, возвращая результат в формате JSON или отклоненный промис в случае ошибки.
- **_request**  
  Выполняет запрос по указанному эндпоинту и возвращает промис с объектом, полученным от сервера.
- **get**  
  Выполняет GET запрос по переданному эндпоинту и возвращает промис с объектом ответа.
- **post**  
  Отправляет объект с данными в формате JSON на указанный эндпоинт. По умолчанию используется метод POST, но это можно изменить, задав третий параметр.

### Класс `EventEmitter`
Реализует паттерн "Наблюдатель", позволяя отправлять события и подписываться на них. Это основа для связи между слоями данных и представления.

- **constructor()**  
  Инициализирует брокер событий.

**Поля:**
- **_events**  
  Хранит события и их подписчиков в виде карты.

**Методы:**
- **on**  
  Подписка на событие.
- **off**  
  Отписка от события.
- **emit**  
  Инициализация события.
- **onAll**  
  Подписка на все события сразу.
- **offAll**  
  Отписка от всех событий.
- **trigger**  
  Возвращает функцию, которая инициирует указанное событие.

### Класс `Component<T>`
Абстрактный базовый класс для создания компонентов пользовательского интерфейса, предоставляющий инструменты для управления DOM-элементами и поведением компонента. Все классы представлений наследуют этот класс.

- **constructor(container: HTMLElement)**  
  Принимает DOM-элемент контейнера для компонента.

**Методы:**
- **toggleClass**  
  Переключает класс для переданного элемента.
- **setText**  
  Устанавливает текстовое содержимое для элемента.
- **setImage**  
  Устанавливает изображение и альтернативный текст для элемента типа `HTMLImageElement`.
- **setDisabled**  
  Меняет состояние активности элемента (включен/выключен).
- **setHidden, setVisible**  
  Скрывает или отображает элемент.
- **render**  
  Рендерит компонент с использованием переданных данных. Этот метод должен быть переопределен в дочерних классах.

### Класс `View<T>`
Этот класс расширяет `Component<T>` и добавляет возможность работы с брокером событий для генерации событий.

- **constructor(container: HTMLElement, protected readonly events: IEvents)**  
  Принимает контейнер для компонента и брокер событий.

**Методы:**
- Все методы полностью наследуются от класса `Component<T>`.

### Класс `Modal`
Реализует модальное окно, предоставляя методы для управления его состоянием и генерации событий (например, `modal:open`, `modal:close`).

- **constructor(container: HTMLElement, protected events: IEvents)**  
  Принимает DOM-элемент модального окна и брокер событий.

**Поля:**
- **_closeButton**  
  Кнопка закрытия модального окна.
- **_content**  
  Элемент с содержимым модального окна.

**Сеттеры:**
- **content**  
  Устанавливает содержимое модального окна.

**Методы:**
- **open**  
  Открывает модальное окно и генерирует событие `modal:open`.
- **close**  
  Закрывает модальное окно, очищает его содержимое и генерирует событие `modal:close`.
- **render**  
  Рендерит модальное окно с переданным содержимым и открывает его.

### Класс `Form`
Реализует форму, предоставляя базовые методы и сеттеры для управления ее состоянием и отображением. Генерирует события `field:change` при изменении полей и `form:submit` при отправке формы.

- **constructor(protected container: HTMLFormElement, protected events: IEvents)**  
  Принимает контейнер формы и брокер событий.

**Поля:**
- **_submit**  
  Кнопка отправки формы.
- **_errors**  
  Элемент для отображения ошибок формы.

**Сеттеры:**
- **valid**  
  Устанавливает доступность кнопки отправки формы в зависимости от переданного состояния.
- **errors**  
  Меняет содержимое компонента с ошибками формы.

**Методы:**
- **onInputChange**  
  Генерирует событие `field:change` при изменении значения поля.
- **render**  
  Рендерит компонент формы с переданными данными.
  
  
### Класс `OrderForm`
Реализует форму для отправки заказа.

- **constructor(container: HTMLFormElement, events: IEvents)**  
  Принимает контейнер формы и брокер событий.

**Поля:**
- **_paymentCard**  
  Кнопка выбора оплаты картой.
- **_paymentCash**  
  Кнопка выбора оплаты наличными.
- **_address**  
  Поле для ввода адреса.

**Сеттеры:**
- **payment**  
  Обновляет классы кнопок в зависимости от типа выбранного способа оплаты.
- **address**  
  Устанавливает значение поля для ввода адреса.


### Класс `Basket`
Реализует корзину и предоставляет методы для управления состоянием корзины.

- **constructor(protected events: IEvents)**  
  Принимает брокер событий.

**Поля:**
- **template**  
  Шаблон корзины.
- **_list**  
  Содержимое корзины.
- **_total**  
  Элемент, отображающий сумму товаров в корзине.
- **_button**  
  Кнопка для оформления заказа.

**Методы:**
- **toggleButton**  
  Меняет состояние активности кнопки оформления заказа.

**Сеттеры:**
- **items**  
  Обновляет содержимое корзины.
- **total**  
  Обновляет значение общей суммы в корзине.

### Класс `Card`
Реализует карточку товара, используемую в каталоге, модальном окне и корзине.

- **constructor(container: HTMLElement, actions?: ICardActions)**  
  Принимает DOM-элемент карточки и опционально объект с колбэками для кликов.

**Поля:**
- **_title**  
  Заголовок карточки.
- **_image**  
  Изображение товара.
- **_price**  
  Цена товара.
- **_category**  
  Категория товара.
- **_description**  
  Описание товара.
- **_button**  
  Кнопка на карточке.

**Сеттеры:**
- **id**  
  Устанавливает id карточки.
- **title**  
  Устанавливает заголовок карточки.
- **price**  
  Устанавливает цену товара.
- **category**  
  Устанавливает категорию товара.
- **image**  
  Устанавливает изображение товара.
- **description**  
  Устанавливает описание товара.
- **button**  
  Устанавливает текст на кнопке.

### Класс `ContactsForm`
Реализует форму для ввода контактных данных.

- **constructor(container: HTMLFormElement, events: IEvents)**  
  Принимает контейнер формы и брокер событий.

**Поля:**
- **_email**  
  Поле для ввода email.
- **_phone**  
  Поле для ввода номера телефона.

**Сеттеры:**
- **email**  
  Устанавливает значение поля для ввода email.
- **phone**  
  Устанавливает значение поля для ввода номера телефона.

### Класс `Page`
Реализует главную страницу с каталогом товаров и счетчиком. Генерирует событие `basket:open` при клике на кнопку корзины.

- **constructor(container: HTMLElement, events: IEvents)**  
  Принимает контейнер главной страницы и брокер событий.

**Поля:**
- **_counter**  
  Элемент счетчика на странице.
- **_catalog**  
  Элемент каталога товаров.
- **_wrapper**  
  Обертка страницы.
- **_basket**  
  Элемент корзины.

**Сеттеры:**
- **counter**  
  Обновляет содержимое счетчика.
- **catalog**  
  Обновляет содержимое каталога товаров.
- **locked**  
  Меняет класс обертки в зависимости от переданного состояния.

### Класс `AppData`
Отвечает за хранение данных и управление ими в приложении.

- **constructor(protected events: IEvents)**  
  Принимает брокер событий.

**Поля:**
- **items**  
  Массив товаров.
- **preview**  
  Текущий товар, отображаемый в модальном окне.
- **basket**  
  Объект корзины с товарами и их суммой.
- **order**  
  Данные заказа.
- **formErrors**  
  Данные ошибок валидации формы.

**Методы:**
- **setItems**  
  Обновляет массив товаров и генерирует событие `items:change`.
- **setPreview**  
  Обновляет товар для превью и генерирует событие `preview:change`.
- **isInBasket**  
  Проверяет наличие товара в корзине.
- **addToBasket**  
  Добавляет товар в корзину и генерирует событие `basket:change`.
- **removeFromBasket**  
  Убирает товар из корзины и генерирует событие `basket:change`.
- **clearBasket**  
  Очищает корзину и генерирует событие `basket:change`.
- **setPayment**  
  Обновляет способ оплаты.
- **setOrderField**  
  Обновляет данные в определенном поле заказа.
- **validateOrder**  
  Проверяет корректность заполненных данных заказа.
- **clearOrder**  
  Очищает данные заказа.

### Класс `Success`
Реализует окно с подтверждением заказа.

- **constructor(container: HTMLElement, events: IEvents, actions: ISuccessActions)**  
  Принимает DOM-элемент окна подтверждения заказа, брокер событий и колбэк для кнопки.

**Поля:**
- **_close**  
  Кнопка закрытия окна.
- **_total**  
  Элемент с суммой заказа.

**Сеттеры:**
- **total**  
  Устанавливает сумму заказа в окне подтверждения.

### Класс `WebLarekApi`
Дополняет базовый класс `Api` методами для работы с сервером конкретного проекта.

- **constructor(cdn: string, baseUrl: string, options?: RequestInit)**  
  Принимает URL контентного сервера, URL сервера для запросов и общие параметры для запросов.

**Поля:**
- **cdn**  
  URL сервера с контентом.

**Методы:**
- **getProductList**  
  Возвращает список продуктов с сервера.
- **getProduct**  
  Возвращает продукт по переданному id.
- **createOrder**  
  Отправляет заказ на сервер и возвращает результат.

### Презентер
Отвечает за координацию взаимодействий компонентов с использованием брокера событий, который отслеживает и генерирует события.

### События приложения
События изменения данных:
- **items:change**  
  Изменение списка товаров.
- **preview:change**  
  Изменение товара для превью.
- **basket:change**  
  Изменение содержимого корзины.
- **formErrors:change**  
  Изменение ошибок валидации формы.

События интерфейса:
- **modal:open**  
  Открытие модального окна.
- **modal:close**  
  Закрытие модального окна.
- **basket:open**  
  Открытие модального окна корзины.
- **card:select**  
  Выбор карточки товара.
- **order:open**  
  Открытие формы оформления заказа.
- **form:submit**  
  Отправка формы.
- **form.field:change**  
  Изменение поля в форме.

### Основные типы/интерфейсы:
- **IProduct**  
  Интерфейс для объекта продукта.
- **IBasket**  
  Интерфейс для корзины.
- **IOrder**  
  Интерфейс для объекта заказа.
- **TOrder**  
  Тип для формы заказа и контактной информации.
- **TOrderForm**  
  Тип для формы заказа.
- **TContactsForm**  
  Тип для формы контактов.
- **IOrderResult**  
  Интерфейс для результата отправки заказа.

